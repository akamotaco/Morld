# entities/characters/yuki.py - 유키 캐릭터 정의

from entities.characters.base import BaseCharacter


class Yuki(BaseCharacter):
    """유키 - 은빛 긴 머리의 조용한 소녀"""

    # === 기본 정보 ===
    ID = 4
    NAME = "유키"
    TYPE = "female"
    START_LOCATION = (0, 10)  # 유키의 방

    # === 태그 (스탯) ===
    TAGS = {
        # 외모
        "외모:은발": 1,
        "외모:장발": 1,
        "외모:붉은눈": 1,
        # 성격
        "성격:수줍음": 1,
        "성격:얌전함": 1,
        # 관계 (플레이어와)
        "애정": 0,
        "성욕": 0,
        "질투": 0,
        # 상태
        "피로": 0,
        "기분": 5,
    }

    # === 외관 묘사 ===
    APPEARANCE = {
        "default": "은빛 긴 머리의 조용한 소녀. 붉은 눈이 신비로운 느낌을 준다.",
        "기쁨": "살짝 볼이 붉어지며 희미하게 웃는다.",
        "슬픔": "고개를 숙이고 있다. 말을 걸기 어려워 보인다.",
        "식사": "조용히 음식을 먹고 있다.",
        "수면": "새근새근 잠들어 있다. 인형 같다.",
        "청소": "열심히 청소하고 있다.",
        "빨래": "빨래를 정성스럽게 널고 있다."
    }

    # === 행동 목록 ===
    ACTIONS = ["script:npc_talk:대화"]

    # === Presence Text (상황 묘사) ===
    PRESENCE_TEXT = {
        # activity 기반
        "activity:청소": "{name}가 조용히 청소하고 있다.",
        "activity:빨래": "{name}가 빨래를 널고 있다.",
        "activity:식사": "{name}가 조용히 식사 중이다.",
        "activity:수면": "{name}가 새근새근 잠들어 있다.",
        "activity:휴식": "{name}가 책을 읽고 있다.",

        # 장소 기반
        "0:4": "{name}가 욕실을 청소하고 있다.",  # 욕실
        "0:1": "{name}가 소파 구석에 앉아 책을 읽고 있다.",  # 거실

        # 기본값
        "default": "{name}가 조용히 서 있다."
    }

    # === 대화 데이터 ===
    DIALOGUES = {
        "default": {"pages": ["......", "...유키... 입니다.", "...청소와 빨래를... 맡고 있어요."]},
        "휴식": {"pages": ["(책을 읽고 있다)", "...아, 네...?", "...괜찮아요..."]},
        "식사": {"pages": ["(조용히 먹고 있다)", "......", "...맛있어요."]},
        "수면": {"pages": ["(자고 있다)", "......"]},
        "청소": {"pages": ["(청소에 집중하고 있다)", "...아, 죄송해요. 좀 비켜주실래요...?"]},
        "빨래": {"pages": ["(빨래를 널고 있다)", "...오늘은 날씨가 좋아서... 빨래가 잘 마를 것 같아요."]},
        "준비": {"pages": ["...좋은 아침이에요.", "......", "(살짝 고개를 숙인다)"]}
    }

    # === 장소 상수 ===
    MY_ROOM = (0, 10)
    DINING = (0, 3)
    LIVING = (0, 1)
    BATHROOM = (0, 4)
    STORAGE = (0, 5)

    # === 시간대별 스케줄 ===
    SCHEDULE = [
        (6, 7, "준비", MY_ROOM),       # 6시~7시: 기상
        (7, 8, "식사", DINING),         # 7시~8시: 아침식사
        (9, 11, "청소", LIVING),        # 9시~11시: 청소 (거실)
        (11, 12, "빨래", BATHROOM),     # 11시~12시: 빨래
        (12, 13, "식사", DINING),       # 12시~13시: 점심식사
        (14, 16, "청소", STORAGE),      # 14시~16시: 청소 (창고)
        (16, 18, "휴식", MY_ROOM),      # 16시~18시: 휴식
        (18, 19, "식사", DINING),       # 18시~19시: 저녁식사 (18:30~19:30)
        (20, 22, "휴식", LIVING),       # 20시~22시: 독서
        (22, 6, "수면", MY_ROOM),       # 22시~다음날 6시: 수면
    ]

    # === 이벤트 핸들러 ===
    def on_meet_player(self) -> dict:
        """플레이어와 처음 만났을 때"""
        if self._first_met:
            return None

        # 수면 중에는 이벤트 없음
        if self.get_activity() == "수면":
            return None

        self._first_met = True
        return {
            "type": "monologue",
            "pages": [
                "...!",
                "...깨어나셨군요.",
                "...유키... 라고 해요.",
                "...필요한 게 있으면... 말해주세요...",
                "(살짝 고개를 숙이고 물러난다)"
            ],
            "time_consumed": 2,
            "button_type": "ok"
        }
